{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="card bg-dark border-info">
            <div class="card-header bg-info text-dark">
                <i class="bi bi-list-check"></i> Security Event Logs
            </div>
            <a href="{{ url_for('download_logs') }}" class="btn btn-info mt-3">
                <i class="bi bi-download"></i> Download Logs as CSV
            </a>            
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-dark table-hover">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>Source IP</th>
                                <th>Destination IP</th>
                                <th>Protocol</th>
                                <th>Port</th>
                                <th>Action</th>
                                <th>Size</th>
                                <th>Alert</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in logs %}
                            <tr class="{% if log.action == 'BLOCK' %}table-danger{% elif log.action == 'DETECT' %}table-warning{% endif %}">
                                <td>{{ log.timestamp }}</td>
                                <td>{{ log.src_ip }}</td>
                                <td>{{ log.dst_ip }}</td>
                                <td>{{ log.protocol }}</td>
                                <td>{{ log.port }}</td>
                                <td>
                                    <span class="badge bg-{% if log.action == 'BLOCK' %}danger{% elif log.action == 'ALLOW' %}success{% else %}warning{% endif %}">
                                        {{ log.action }}
                                    </span>
                                </td>
                                <td>{{ log.size }} bytes</td>
                                <td>
                                    {% if log.alert %}
                                    <span class="badge bg-danger">{{ log.alert }}</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer text-muted">
                Showing last {{ logs|length }} events
            </div>
        </div>
    </div>
</div>
{% endblock %}